\documentclass[a4paper, 10pt]{article}
\usepackage{moderntex}


\title{Numerical Solution of Differential Equations\\by Difference Methods}
\author{Trym SÃ¦ther}
\date{\today}
\begin{document}

\sloppy

\maketitle
\tableofcontents
\newpage

\input{sections/FDM}
\input{sections/FEM}

\subsection{Lecture 8 (28.1.2025)}

\begin{theorem}{Lax-Equivalence-Theorem}{}
    \[
        \text{Consistency} + \text{Stability} \iff \text{Convergence}
    \]
    Holds for linear (time-dependent) problems.
\end{theorem}

PDE:

\begin{align*}
    u_t + u_x  = au, \quad \R \\
    u(x, 0) = f(x) \tag{IC}   \\
    u(0, t) = g(t) \tag{BC}   \\
    u(x,t) =
    \begin{cases}
        e^{at}f(x-t), & x < t \\
        e^{at}g(t-x), & x > t
    \end{cases}
\end{align*}

\paragraph{Scheme:}
\begin{align*}
    U_m^{n+1} = U_m^n - \frac{K}{h}(U_m^n - U_{m-1}^n) + aKU_m^n \\
    \tau_m^n = \frac{1}{2}(K\partial_t^2 u_m^n - h\partial_x^2 u_m^n) + O(K^2 + h^2)
\end{align*}

\[
    \norm{\vec{\tau}^n} \underset{h, K \to 0}{\longrightarrow} 0 \tag{Consistency}
\]

\paragraph{Stencil:}
\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \draw[step=1cm,gray,very thin] (-0.9,-0.9) grid (1.9,1.9);
        \draw[->] (-1,0) -- (2,0) node[below] {$m$};
        \draw[->] (0,-1) -- (0,2) node[left] {$n$};
        \filldraw[black] (0,0) circle (2pt) node[below right] {$(m,n)$};
        \filldraw[black] (-1,0) circle (2pt) node[below left] {$(m-1,n)$};
        \filldraw[black] (0,1) circle (2pt) node[above right] {$(m,n+1)$};
        \draw[->,thick] (0,0) -- (0,1);
        \draw[->,thick] (-1,0) -- (0,0);
    \end{tikzpicture}
    \caption{Stencil}
    \label{fig:stencil}
\end{figure}

\paragraph{Stability:}
Find \(C\). Define \( S = \frac{K}{h} \).

\[
    U_m^{n+1} = (1 - S + aK)U_m^n + SU_{m-1}^n
\]

\[
    \begin{bmatrix}
        U_1^{n+1} \\
        U_2^{n+1} \\
        \\
        \vdots    \\
        \\
        U_M^{n+1}
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 - S + aK & 0          & 0          & \cdots & 0          \\
        S          & 1 - S + aK & 0          & \cdots & 0          \\
        0          & S          & 1 - S + aK & \cdots & 0          \\
        \vdots     & \vdots     & \vdots     & \ddots & \vdots     \\
        0          & \cdots     & 0          & S      & 1 - S + aK
    \end{bmatrix}
    \begin{bmatrix}
        U_1^n  \\
        U_2^n  \\
        \\
        \vdots \\
        \\
        U_M^n
    \end{bmatrix}
    +
    \begin{bmatrix}
        \overbrace{S g(t_0)}^{U_0^n} \\
        0                            \\
        \vdots                       \\
        0                            \\
        \overbrace{S g(t_n)}^{U_{M+1}^n}
    \end{bmatrix}
\]

\begin{example}{}{}
    \begin{align*}
        u_t = u_{xx} \text{ on } [0,1] \\
        u(x, 0) = f(x)                 \\
        u(1, t) = 0                    \\
        u(0, t) + u_x(0, t) = 0
    \end{align*}
    \paragraph{Scheme}
    let \( r= \frac{K}{h^2} \)
    \[
        U_m^{n+1} = U_m^n + r(U_{m-1}^n - 2U_m^n + U_{m+1}^n)
    \]
    \paragraph{Boundary Conditions}
    \begin{align*}
        U_0^{n+1} = U_0^n + r(U_1^n - 2U_0^n + U_{-1}^n)        \\
        U_0^n + \frac{1}{2h}(U_1^n - U_{-1}^n) = 0              \\
        U_{-1}^n = U_1^n + 2hU_0^n                              \\
        U_0^{n+1} = U_0^n + r(U_1^n - 2U_0^n + U_1^n + 2hU_0^n) \\
        U_0^{n+1} = U_0^n + r(2U_1^n - 4U_0^n)                  \\
        U_0^{n+1} = U_0^n + 2rU_1^n - 4rU_0^n                   \\
        U_0^{n+1} = (1 - 2r(1 - h))U_0^n + 2rU_1^n
    \end{align*}
    Let \( \vec{U}^n = \begin{bmatrix} U_0^n \\ U_1^n \\ \vdots \\ U_M^n \end{bmatrix} \) where \( U_M^n = 0 \).

    \[
        C = \begin{bmatrix}
            1 - 2r(1 - h) & 2r     & 0      & \cdots & 0      \\
            r             & 1 - 2r & r      & \cdots & 0      \\
            0             & r      & 1 - 2r & \cdots & 0      \\
            \vdots        & \vdots & \vdots & \ddots & \vdots \\
            0             & \cdots & 0      & r      & 1 - 2r
        \end{bmatrix}
    \]

    Need to find \( r \leq \frac{1}{2} \) for \(m = 1, 2, \ldots, M-1\) to ensure stability.
    For \( m = 0 \) we need:
    \begin{align*}
        \abs{1 - 2r(1 - h)} + \abs{2r} \leq 1 + \mu K \\
        \abs{1 - 2r(1 - h)} + 2r \leq \abs{1 - 2r} + 2rh + \abs{2r} = 1 + 2rh = 1 + \underbrace{\frac{2}{h}}_{\mu}K
    \end{align*}
    Stable for a given \( h \) but not when \( h \to 0 \).
    \begin{align*}
        K \tau_0^n =                              & u(0, t_n + h) - u(0, t_n) + 2r(1 - h)u(0, t_n) - 2ru(h, t_n)                                                                                                                                            \\                                                                                                                                                                                                                    \\
        =            u_0^n + K \partial_t u_0^n + & \frac{1}{2}K^2 \partial_t^2 u_0^n + \ldots - u_0^n                                                                                                                                                      \\
        +                                         & 2\frac{K}{h^2}(1 - h)u_0^n - 2\frac{K}{h^2}(u_0^n + h \partial_x u_0^n + \frac{1}{2}h^2 \partial_x^2 u_0^n + \frac{1}{6}h^3 \partial_x^3 u_0^n + \frac{1}{24}h^4 \partial_x^4 u_0^n + \ldots)           \\
                                                  & = \frac{K}{h^2}\left[-h(u_0^n + \partial_x u_0^n)\right] + K \left[\partial_t u_0^n - \partial_x^2 u_0^n\right] - \frac{1}{3}Kh\partial_x^3 u_0^n + \ldots + \frac{1}{2}K^2 \partial_t^2 u_0^n + \ldots \\
        K \tau_0^n                                & = -\frac{1}{3}Kh\partial_x^3 u_0^n + \ldots + \frac{1}{2}K^2 \partial_t^2 u_0^n + \ldots \tag{Consistency}
    \end{align*}
\end{example}

\subsection*{Alternative stability analysis: Von Neumann analysis}
Von Neumann analysis is a method for analyzing the stability of finite difference schemes for linear partial differential equations.
The method is based on the Fourier analysis of the numerical solution.

\begin{theorem}{Parseval's equality}{}
    \[
        \sum_{l=-\infty}^{\infty} \abs{C_l}^2 = \frac{1}{2\pi} \int_0^{2\pi} \abs{f(x)}^2 \dd{x}
    \]
\end{theorem}

\begin{example}{}{}
    \begin{align*}
        u_t = u_{xx} \text{ on } [0,1] \\
        u(x, 0) = f(x)                 \\
    \end{align*}
    Make a periodic extension of \(f\), s.t. \(f(x) = f(x-1)\).
    Assue that \(u(x-1, t) = u(x, t)\) and \(u(1, t) = u(0, t)\).
    Write \(f(x)\) as a complex Fourier series:
    \begin{align*}
        f(x) & = \sum_{k=-\infty}^{\infty} C_l e^{i \beta_l x}, \quad \beta_l = 2\pi l, \quad l \in \Z \\
        C_l  & = \int_0^1 f(x) e^{-i \beta_l x} \dd{x}
    \end{align*}

    Seperation of variables:
    \[
        u_l(x, t) = e^{-\beta_l^2 t} e^{i \beta_l x}
    \]
    Plug in the (IC):
    \[
        u(x, t) = \sum_{l=-\infty}^{\infty} C_l e^{-\beta_l^2 t} e^{i \beta_l x}
    \]
    \subparagraph{Idea}
    Given a scheme for \(u_t = u_{xx}\), we can write:
    \[
        U_m^{n+1} = U_m^n + r(U_{m-1}^n - 2U_m^n + U_{m+1}^n), \quad r = \frac{k}{h^2}
    \]

    Search for a solution of the form:
    \[
        U_m^n = \psi^n e^{i \beta x_m}
    \]
    A scheme is \textit{Von Neumann stable} if:
    \[
        \abs{\psi} < 1 + \mu k, \quad \mu \geq 0
    \]

    In our example:
    \begin{align*}
        \psi^{n+1} e^{i \beta x_m} & = \psi^n e^{i \beta x_m} + r\psi^n\left(e^{i \beta x_{m+1}} - 2e^{i \beta x_m} + e^{i \beta x_{m-1}}\right) \\
                                   & = \psi^n e^{i \beta x_m} (1 + r(e^{i \beta h} - 2 + e^{-i \beta h}))                                        \\
        \psi                       & = 1 + r(e^{i \beta h} - 2 + e^{-i \beta h})                                                                 \\
                                   & = 1 + r(2\cos(\beta h) - 2)                                                                                     \\
                                      & = 1 + 4r\sin^2\left(\frac{\beta h}{2}\right)                                                                    \\
        \abs{\psi}                 & = \abs{1 + 4r\sin^2\left(\frac{\beta h}{2}\right)} \leq 1 \iff r \leq \frac{1}{2}, \forall \beta \text{ and } \mu = 0
    \end{align*}
\end{example}

\input{sections/lectures/lectures.tex}

\end{document}